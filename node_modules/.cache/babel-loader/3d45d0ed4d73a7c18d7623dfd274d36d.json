{"ast":null,"code":"var _jsxFileName = \"/home/gustazacchi/gestao-de-habitos/src/pages/MyAcount/index.js\",\n    _s = $RefreshSig$();\n\nimport Input from \"../../components/Input\";\nimport { Container, AnimationContainer, Button } from \"./styles\";\nimport { FiUser, FiVoicemail, FiLock } from \"react-icons/fi\";\nimport * as yup from 'yup';\nimport { useForm } from \"react-hook-form\";\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport api from \"../../services/api\";\nimport { toast } from 'react-toastify';\nimport jwt_decode from \"jwt-decode\";\nimport { useEffect, useState } from 'react';\nimport { Redirect, useHistory } from \"react-router\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst MyAcount = () => {\n  _s();\n\n  var _errors$username, _errors$password, _errors$username2;\n\n  const history = useHistory();\n  const [token, setToken] = useState(null);\n  const [usuario, setUsuario] = useState('');\n  const [decode, setDecode] = useState('');\n\n  const getToken = () => {\n    const localToken = JSON.parse(localStorage.getItem('@GestãoDeHábitos:access'));\n    api.defaults.headers.authorization = `Bearer ${localToken}`;\n    setToken(JSON.parse(localStorage.getItem('@GestãoDeHábitos:access')));\n\n    if (token) {\n      setDecode(jwt_decode(JSON.parse(localStorage.getItem('@GestãoDeHábitos:access'))));\n    }\n  };\n\n  const forSchema = yup.object().shape({\n    usernameAtual: yup.string().required(\"Username Obrigatótio\"),\n    pass: yup.string().required(\"Campo Obrigatório\"),\n    password: yup.string()\n  });\n  const {\n    register,\n    handleSubmit,\n    formState: {\n      errors\n    }\n  } = useForm({\n    resolver: yupResolver(forSchema)\n  });\n\n  const handleSubmitFunction = data => {\n    var confirm = {\n      username: `${data.usernameAtual}`,\n      password: `${data.pass}`\n    };\n    api.post(\"/sessions/\", confirm).then(() => {\n      if (token) {\n        api.patch(`/users/${decode.user_id}/`, data, {\n          Authorization: `Bearer ${token}`\n        }).then(() => {\n          toast.success(`Your Username Is ${data.username}`);\n        }).then(() => submitFunction()).catch(err => toast.error('User Already Exists'));\n      } else {\n        return;\n      }\n    }).catch(err => toast.error('Password or User Incorrect'));\n  };\n\n  const submitFunction = () => {\n    if (token) {\n      var decode = jwt_decode(token);\n      api.get(`/users/${decode.user_id}/`).then(response => setUsuario(response.data)).catch(err => console.log('Erro ao exibir usuário'));\n    }\n  };\n\n  useEffect(() => {\n    getToken();\n    submitFunction();\n  }, [token]);\n  const tok = JSON.parse(localStorage.getItem(\"@GestãoDeHábitos:access\")) || \"\";\n\n  if (!tok) {\n    return /*#__PURE__*/_jsxDEV(Redirect, {\n      to: \"/login\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 20\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Change User\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(AnimationContainer, {\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit(handleSubmitFunction),\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Username: \", /*#__PURE__*/_jsxDEV(\"a\", {\n            children: usuario.username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 74,\n            columnNumber: 34\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Email: \", /*#__PURE__*/_jsxDEV(\"a\", {\n            children: usuario.email\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 75,\n            columnNumber: 31\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSubmit(),\n          children: [/*#__PURE__*/_jsxDEV(Input, {\n            register: register,\n            name: \"usernameAtual\",\n            icon: FiUser,\n            placeholder: \"Your Username\",\n            error: (_errors$username = errors.username) === null || _errors$username === void 0 ? void 0 : _errors$username.message\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Input, {\n            register: register,\n            name: \"pass\",\n            icon: FiLock,\n            placeholder: \"Your Password\",\n            type: \"password\",\n            error: (_errors$password = errors.password) === null || _errors$password === void 0 ? void 0 : _errors$password.message\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          register: register,\n          name: \"username\",\n          icon: FiUser,\n          placeholder: \"Your New Username\",\n          error: (_errors$username2 = errors.username) === null || _errors$username2 === void 0 ? void 0 : _errors$username2.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          type: \"submit\",\n          size: '100%',\n          children: \"Change\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          size: '40%',\n          margin: '40px',\n          onClick: () => (localStorage.removeItem('@GestãoDeHábitos:access'), history.push(\"/login\")),\n          children: \"Logout\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 15\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 9\n  }, this);\n};\n\n_s(MyAcount, \"/46IPosBxmvhpAVVwcvNh+TSKr0=\", false, function () {\n  return [useHistory, useForm];\n});\n\n_c = MyAcount;\nexport default MyAcount;\n\nvar _c;\n\n$RefreshReg$(_c, \"MyAcount\");","map":{"version":3,"sources":["/home/gustazacchi/gestao-de-habitos/src/pages/MyAcount/index.js"],"names":["Input","Container","AnimationContainer","Button","FiUser","FiVoicemail","FiLock","yup","useForm","yupResolver","api","toast","jwt_decode","useEffect","useState","Redirect","useHistory","MyAcount","history","token","setToken","usuario","setUsuario","decode","setDecode","getToken","localToken","JSON","parse","localStorage","getItem","defaults","headers","authorization","forSchema","object","shape","usernameAtual","string","required","pass","password","register","handleSubmit","formState","errors","resolver","handleSubmitFunction","data","confirm","username","post","then","patch","user_id","Authorization","success","submitFunction","catch","err","error","get","response","console","log","tok","email","message","removeItem","push"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,wBAAlB;AACA,SAAQC,SAAR,EAAkBC,kBAAlB,EAAsCC,MAAtC,QAAmD,UAAnD;AACA,SAAQC,MAAR,EAAgBC,WAAhB,EAA6BC,MAA7B,QAA0C,gBAA1C;AACA,OAAO,KAAKC,GAAZ,MAAqB,KAArB;AACA,SAASC,OAAT,QAAwB,iBAAxB;AACA,SAASC,WAAT,QAA4B,yBAA5B;AACA,OAAOC,GAAP,MAAgB,oBAAhB;AACA,SAAQC,KAAR,QAAqB,gBAArB;AACA,OAAOC,UAAP,MAAuB,YAAvB;AACA,SAASC,SAAT,EAAmBC,QAAnB,QAAkC,OAAlC;AACA,SAASC,QAAT,EAAmBC,UAAnB,QAAqC,cAArC;;;AAEA,MAAMC,QAAQ,GAAG,MAAM;AAAA;;AAAA;;AACnB,QAAMC,OAAO,GAAGF,UAAU,EAA1B;AACA,QAAM,CAACG,KAAD,EAAQC,QAAR,IAAoBN,QAAQ,CAAC,IAAD,CAAlC;AACA,QAAM,CAACO,OAAD,EAAUC,UAAV,IAAwBR,QAAQ,CAAC,EAAD,CAAtC;AACA,QAAM,CAACS,MAAD,EAASC,SAAT,IAAsBV,QAAQ,CAAC,EAAD,CAApC;;AAGA,QAAMW,QAAQ,GAAG,MAAM;AACnB,UAAMC,UAAU,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,yBAArB,CAAX,CAAnB;AACApB,IAAAA,GAAG,CAACqB,QAAJ,CAAaC,OAAb,CAAqBC,aAArB,GAAsC,UAASP,UAAW,EAA1D;AACAN,IAAAA,QAAQ,CAACO,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,yBAArB,CAAX,CAAD,CAAR;;AACA,QAAIX,KAAJ,EAAW;AACPK,MAAAA,SAAS,CAACZ,UAAU,CAACe,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,yBAArB,CAAX,CAAD,CAAX,CAAT;AACH;AACJ,GAPD;;AAQA,QAAMI,SAAS,GAAG3B,GAAG,CAAC4B,MAAJ,GAAaC,KAAb,CAAmB;AACjCC,IAAAA,aAAa,EAAE9B,GAAG,CAAC+B,MAAJ,GAAaC,QAAb,CAAsB,sBAAtB,CADkB;AAEjCC,IAAAA,IAAI,EAAEjC,GAAG,CAAC+B,MAAJ,GAAaC,QAAb,CAAsB,mBAAtB,CAF2B;AAGjCE,IAAAA,QAAQ,EAAElC,GAAG,CAAC+B,MAAJ;AAHuB,GAAnB,CAAlB;AAKA,QAAK;AAACI,IAAAA,QAAD;AAAWC,IAAAA,YAAX;AAAyBC,IAAAA,SAAS,EAAC;AAACC,MAAAA;AAAD;AAAnC,MAA+CrC,OAAO,CAAC;AACxDsC,IAAAA,QAAQ,EAAErC,WAAW,CAACyB,SAAD;AADmC,GAAD,CAA3D;;AAGA,QAAMa,oBAAoB,GAAIC,IAAD,IAAU;AACnC,QAAIC,OAAO,GAAG;AAACC,MAAAA,QAAQ,EAAE,GAAEF,IAAI,CAACX,aAAc,EAAhC;AAAmCI,MAAAA,QAAQ,EAAE,GAAEO,IAAI,CAACR,IAAK;AAAzD,KAAd;AACA9B,IAAAA,GAAG,CAACyC,IAAJ,CAAS,YAAT,EAAuBF,OAAvB,EACCG,IADD,CACM,MAAK;AACP,UAAGjC,KAAH,EAAS;AACLT,QAAAA,GAAG,CAAC2C,KAAJ,CAAW,UAAS9B,MAAM,CAAC+B,OAAQ,GAAnC,EAAuCN,IAAvC,EAA6C;AAACO,UAAAA,aAAa,EAAG,UAASpC,KAAM;AAAhC,SAA7C,EACCiC,IADD,CACM,MAAK;AAACzC,UAAAA,KAAK,CAAC6C,OAAN,CAAe,oBAAmBR,IAAI,CAACE,QAAS,EAAhD;AAAmD,SAD/D,EAECE,IAFD,CAEM,MAAIK,cAAc,EAFxB,EAGCC,KAHD,CAGQC,GAAD,IAAShD,KAAK,CAACiD,KAAN,CAAY,qBAAZ,CAHhB;AAIH,OALD,MAKK;AAAC;AAAO;AAChB,KARD,EASCF,KATD,CASQC,GAAD,IAAShD,KAAK,CAACiD,KAAN,CAAY,4BAAZ,CAThB;AAUH,GAZD;;AAaA,QAAMH,cAAc,GAAG,MAAM;AACzB,QAAGtC,KAAH,EAAS;AACL,UAAII,MAAM,GAAGX,UAAU,CAACO,KAAD,CAAvB;AACAT,MAAAA,GAAG,CAACmD,GAAJ,CAAS,UAAStC,MAAM,CAAC+B,OAAQ,GAAjC,EACCF,IADD,CACOU,QAAD,IAAaxC,UAAU,CAACwC,QAAQ,CAACd,IAAV,CAD7B,EAECU,KAFD,CAEQC,GAAD,IAASI,OAAO,CAACC,GAAR,CAAY,wBAAZ,CAFhB;AAGH;AACJ,GAPD;;AAQAnD,EAAAA,SAAS,CAAC,MAAM;AACZY,IAAAA,QAAQ;AACRgC,IAAAA,cAAc;AACb,GAHI,EAIJ,CAACtC,KAAD,CAJI,CAAT;AAMI,QAAM8C,GAAG,GAAGtC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,yBAArB,CAAX,KAA+D,EAA3E;;AACA,MAAG,CAACmC,GAAJ,EAAQ;AACJ,wBAAO,QAAC,QAAD;AAAU,MAAA,EAAE,EAAC;AAAb;AAAA;AAAA;AAAA;AAAA,YAAP;AACH;;AAGL,sBACI,QAAC,SAAD;AAAA,4BACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADJ,eAEI,QAAC,kBAAD;AAAA,6BACE;AAAM,QAAA,QAAQ,EAAEtB,YAAY,CAACI,oBAAD,CAA5B;AAAA,gCACM;AAAA,gDAAa;AAAA,sBAAI1B,OAAO,CAAC6B;AAAZ;AAAA;AAAA;AAAA;AAAA,kBAAb;AAAA;AAAA;AAAA;AAAA;AAAA,gBADN,eAEM;AAAA,6CAAU;AAAA,sBAAI7B,OAAO,CAAC6C;AAAZ;AAAA;AAAA;AAAA;AAAA,kBAAV;AAAA;AAAA;AAAA;AAAA;AAAA,gBAFN,eAGM;AAAM,UAAA,QAAQ,EAAEvB,YAAY,EAA5B;AAAA,kCACI,QAAC,KAAD;AAAO,YAAA,QAAQ,EAAED,QAAjB;AAA2B,YAAA,IAAI,EAAC,eAAhC;AAAgD,YAAA,IAAI,EAAEtC,MAAtD;AAA8D,YAAA,WAAW,EAAC,eAA1E;AAA0F,YAAA,KAAK,sBAAEyC,MAAM,CAACK,QAAT,qDAAE,iBAAiBiB;AAAlH;AAAA;AAAA;AAAA;AAAA,kBADJ,eAEI,QAAC,KAAD;AAAO,YAAA,QAAQ,EAAEzB,QAAjB;AAA2B,YAAA,IAAI,EAAC,MAAhC;AAAuC,YAAA,IAAI,EAAEpC,MAA7C;AAAqD,YAAA,WAAW,EAAC,eAAjE;AAAiF,YAAA,IAAI,EAAC,UAAtF;AAAiG,YAAA,KAAK,sBAAEuC,MAAM,CAACJ,QAAT,qDAAE,iBAAiB0B;AAAzH;AAAA;AAAA;AAAA;AAAA,kBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBAHN,eAOM,QAAC,KAAD;AAAO,UAAA,QAAQ,EAAEzB,QAAjB;AAA2B,UAAA,IAAI,EAAC,UAAhC;AAA2C,UAAA,IAAI,EAAEtC,MAAjD;AAAyD,UAAA,WAAW,EAAC,mBAArE;AAAyF,UAAA,KAAK,uBAAEyC,MAAM,CAACK,QAAT,sDAAE,kBAAiBiB;AAAjH;AAAA;AAAA;AAAA;AAAA,gBAPN,eAQM,QAAC,MAAD;AAAQ,UAAA,IAAI,EAAC,QAAb;AAAsB,UAAA,IAAI,EAAE,MAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBARN,eASM,QAAC,MAAD;AAAQ,UAAA,IAAI,EAAE,KAAd;AAAqB,UAAA,MAAM,EAAE,MAA7B;AAAqC,UAAA,OAAO,EAAE,OAAKtC,YAAY,CAACuC,UAAb,CAAwB,yBAAxB,GAAoDlD,OAAO,CAACmD,IAAR,CAAa,QAAb,CAAzD,CAA9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBATN;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,UADJ;AAmBH,CA3ED;;GAAMpD,Q;UACcD,U,EAmBoCR,O;;;KApBlDS,Q;AA4EN,eAAeA,QAAf","sourcesContent":["import Input from \"../../components/Input\"\nimport {Container,AnimationContainer, Button} from \"./styles\"\nimport {FiUser, FiVoicemail, FiLock} from \"react-icons/fi\"\nimport * as yup from 'yup';\nimport { useForm } from \"react-hook-form\";\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport api from \"../../services/api\"\nimport{ toast } from 'react-toastify'\nimport jwt_decode from \"jwt-decode\"\nimport { useEffect,useState} from 'react'\nimport { Redirect, useHistory } from \"react-router\";\n\nconst MyAcount = () => {\n    const history = useHistory()\n    const [token, setToken] = useState(null)\n    const [usuario, setUsuario] = useState('')\n    const [decode, setDecode] = useState('')\n    \n\n    const getToken = () => {\n        const localToken = JSON.parse(localStorage.getItem('@GestãoDeHábitos:access'))\n        api.defaults.headers.authorization = `Bearer ${localToken}`;\n        setToken(JSON.parse(localStorage.getItem('@GestãoDeHábitos:access')))\n        if (token) {\n            setDecode(jwt_decode(JSON.parse(localStorage.getItem('@GestãoDeHábitos:access'))))\n        }\n    }\n    const forSchema = yup.object().shape({\n        usernameAtual: yup.string().required(\"Username Obrigatótio\"),\n        pass: yup.string().required(\"Campo Obrigatório\"),\n        password: yup.string(),\n      })\n    const{register, handleSubmit, formState:{errors}} = useForm({\n        resolver: yupResolver(forSchema)\n    });  \n    const handleSubmitFunction = (data) => {\n        var confirm = {username:`${data.usernameAtual}`, password:`${data.pass}`}\n        api.post(\"/sessions/\", confirm)\n        .then(()=> {\n            if(token){\n                api.patch(`/users/${decode.user_id}/`, data, {Authorization: `Bearer ${token}`})\n                .then(()=> {toast.success(`Your Username Is ${data.username}`)})\n                .then(()=>submitFunction())\n                .catch((err) => toast.error('User Already Exists'))\n            }else{return}\n        })\n        .catch((err) => toast.error('Password or User Incorrect'))  \n    }\n    const submitFunction = () => {\n        if(token){\n            var decode = jwt_decode(token)\n            api.get(`/users/${decode.user_id}/`)\n            .then((response)=> setUsuario(response.data))\n            .catch((err) => console.log('Erro ao exibir usuário'))\n        }   \n    }\n    useEffect(() => {\n        getToken()\n        submitFunction()\n        }\n        ,[token])\n\n        const tok = JSON.parse(localStorage.getItem(\"@GestãoDeHábitos:access\")) || \"\";\n        if(!tok){\n            return <Redirect to=\"/login\"/>\n        }\n\n\n    return(\n        <Container>\n            <h1>Change User</h1>\n            <AnimationContainer>\n              <form onSubmit={handleSubmit(handleSubmitFunction)}>\n                    <p>Username: <a>{usuario.username}</a></p>\n                    <p>Email: <a>{usuario.email}</a></p>\n                    <form onSubmit={handleSubmit()}>\n                        <Input register={register} name=\"usernameAtual\" icon={FiUser} placeholder=\"Your Username\" error={errors.username?.message}/>\n                        <Input register={register} name=\"pass\" icon={FiLock} placeholder=\"Your Password\" type=\"password\" error={errors.password?.message}/>\n                    </form>\n                    <Input register={register} name=\"username\" icon={FiUser} placeholder=\"Your New Username\" error={errors.username?.message}/>\n                    <Button type=\"submit\" size={'100%'}>Change</Button>\n                    <Button size={'40%'} margin={'40px'} onClick={()=>(localStorage.removeItem('@GestãoDeHábitos:access'), history.push(\"/login\"))} >Logout</Button>\n              </form>\n            </AnimationContainer>\n            \n        </Container>\n    )\n}\nexport default MyAcount\n"]},"metadata":{},"sourceType":"module"}