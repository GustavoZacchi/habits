{"ast":null,"code":"var _jsxFileName = \"/home/gustazacchi/gestao-de-habitos/src/pages/MyAcount/index.js\",\n    _s = $RefreshSig$();\n\nimport Input from \"../../components/Input\";\nimport { Container, AnimationContainer, Button } from \"./styles\";\nimport { FiUser, FiVoicemail, FiLock } from \"react-icons/fi\";\nimport * as yup from 'yup';\nimport { useForm } from \"react-hook-form\";\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport api from \"../../services/api\";\nimport { toast } from 'react-toastify';\nimport jwt_decode from \"jwt-decode\";\nimport { useEffect, useState } from 'react';\nimport { Redirect, useHistory } from \"react-router\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst MyAcount = () => {\n  _s();\n\n  var _errors$username, _errors$email;\n\n  const history = useHistory();\n  const [token, setToken] = useState(null);\n  const [usuario, setUsuario] = useState('');\n  const [decode, setDecode] = useState('');\n\n  const getToken = () => {\n    const localToken = JSON.parse(localStorage.getItem('@GestãoDeHábitos:access'));\n    api.defaults.headers.authorization = `Bearer ${localToken}`;\n    setToken(JSON.parse(localStorage.getItem('@GestãoDeHábitos:access')));\n\n    if (token) {\n      setDecode(jwt_decode(JSON.parse(localStorage.getItem('@GestãoDeHábitos:access'))));\n    }\n  };\n\n  const forSchema = yup.object().shape({\n    username: yup.string(),\n    email: yup.string()\n  });\n  const {\n    register,\n    handleSubmit,\n    formState: {\n      errors\n    }\n  } = useForm({\n    resolver: yupResolver(forSchema)\n  });\n\n  const handleSubmitFunction = data => {\n    if (!data.email) {\n      console.log(data);\n      data.email = usuario.email;\n    } else if (!data.username) {\n      console.log(data);\n      data.username = usuario.username;\n    }\n\n    if (token) {\n      api.patch(`/users/${decode.user_id}/`, data, {\n        Authorization: `Bearer ${token}`\n      }).then(() => {\n        toast.success(`Your Email Is ${data.email}`);\n      }).then(() => {\n        toast.success(`Your Username Is ${data.username}`);\n      }).then(() => submitFunction()).catch(err => toast.error('Erro ao editar usuário'));\n    } else {\n      return;\n    }\n  };\n\n  const submitFunction = () => {\n    if (token) {\n      var decode = jwt_decode(token);\n      api.get(`/users/${decode.user_id}/`).then(response => setUsuario(response.data)).catch(err => console.log('Erro ao exibir usuário'));\n    }\n  };\n\n  useEffect(() => {\n    getToken();\n    submitFunction();\n  }, [token]);\n  const tok = JSON.parse(localStorage.getItem(\"@GestãoDeHábitos:access\")) || \"\";\n\n  if (!tok) {\n    return /*#__PURE__*/_jsxDEV(Redirect, {\n      to: \"/login\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 20\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Change User\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(AnimationContainer, {\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit(handleSubmitFunction),\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Username: \", /*#__PURE__*/_jsxDEV(\"a\", {\n            children: usuario.username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 34\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Email: \", /*#__PURE__*/_jsxDEV(\"a\", {\n            children: usuario.email\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 31\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          register: register,\n          name: \"username\",\n          icon: FiUser,\n          placeholder: \"Your New Username\",\n          error: (_errors$username = errors.username) === null || _errors$username === void 0 ? void 0 : _errors$username.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          register: register,\n          name: \"email\",\n          icon: FiVoicemail,\n          placeholder: \"Your New Email\",\n          error: (_errors$email = errors.email) === null || _errors$email === void 0 ? void 0 : _errors$email.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          type: \"submit\",\n          size: '100%',\n          children: \"Change\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          size: '40%',\n          margin: '40px',\n          onClick: () => (localStorage.removeItem('@GestãoDeHábitos:access'), history.push(\"/login\")),\n          children: \"Logout\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 15\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 9\n  }, this);\n};\n\n_s(MyAcount, \"/46IPosBxmvhpAVVwcvNh+TSKr0=\", false, function () {\n  return [useHistory, useForm];\n});\n\n_c = MyAcount;\nexport default MyAcount;\n\nvar _c;\n\n$RefreshReg$(_c, \"MyAcount\");","map":{"version":3,"sources":["/home/gustazacchi/gestao-de-habitos/src/pages/MyAcount/index.js"],"names":["Input","Container","AnimationContainer","Button","FiUser","FiVoicemail","FiLock","yup","useForm","yupResolver","api","toast","jwt_decode","useEffect","useState","Redirect","useHistory","MyAcount","history","token","setToken","usuario","setUsuario","decode","setDecode","getToken","localToken","JSON","parse","localStorage","getItem","defaults","headers","authorization","forSchema","object","shape","username","string","email","register","handleSubmit","formState","errors","resolver","handleSubmitFunction","data","console","log","patch","user_id","Authorization","then","success","submitFunction","catch","err","error","get","response","tok","message","removeItem","push"],"mappings":"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","sourcesContent":["import Input from \"../../components/Input\"\nimport {Container,AnimationContainer, Button} from \"./styles\"\nimport {FiUser, FiVoicemail, FiLock} from \"react-icons/fi\"\nimport * as yup from 'yup';\nimport { useForm } from \"react-hook-form\";\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport api from \"../../services/api\"\nimport{ toast } from 'react-toastify'\nimport jwt_decode from \"jwt-decode\"\nimport { useEffect,useState} from 'react'\nimport { Redirect, useHistory } from \"react-router\";\n\nconst MyAcount = () => {\n    const history = useHistory()\n    const [token, setToken] = useState(null)\n    const [usuario, setUsuario] = useState('')\n    const [decode, setDecode] = useState('')\n    \n\n    const getToken = () => {\n        const localToken = JSON.parse(localStorage.getItem('@GestãoDeHábitos:access'))\n        api.defaults.headers.authorization = `Bearer ${localToken}`;\n        setToken(JSON.parse(localStorage.getItem('@GestãoDeHábitos:access')))\n        if (token) {\n            setDecode(jwt_decode(JSON.parse(localStorage.getItem('@GestãoDeHábitos:access'))))\n        }\n    }\n    const forSchema = yup.object().shape({\n        username: yup.string(),\n        email: yup.string()\n      })\n    const{register, handleSubmit, formState:{errors}} = useForm({\n        resolver: yupResolver(forSchema)\n    });  \n    \n    const handleSubmitFunction = (data) => {\n        if(!data.email){\n            console.log(data)\n            data.email=usuario.email \n        }else if(!data.username){\n            console.log(data)\n            data.username=usuario.username \n        }\n        if(token){\n            api.patch(`/users/${decode.user_id}/`, data, {Authorization: `Bearer ${token}`})\n            .then(()=> {toast.success(`Your Email Is ${data.email}`)})\n            .then(()=> {toast.success(`Your Username Is ${data.username}`)})\n            .then(()=>submitFunction())\n            .catch((err) => toast.error('Erro ao editar usuário'))\n        }else{return}\n    }\n    const submitFunction = () => {\n        if(token){\n            var decode = jwt_decode(token)\n            api.get(`/users/${decode.user_id}/`)\n            .then((response)=> setUsuario(response.data))\n            .catch((err) => console.log('Erro ao exibir usuário'))\n        }   \n    }\n    useEffect(() => {\n        getToken()\n        submitFunction()\n        }\n        ,[token])\n\n        const tok = JSON.parse(localStorage.getItem(\"@GestãoDeHábitos:access\")) || \"\";\n        if(!tok){\n            return <Redirect to=\"/login\"/>\n        }\n\n\n    return(\n        <Container>\n            <h1>Change User</h1>\n            <AnimationContainer>\n              <form onSubmit={handleSubmit(handleSubmitFunction)}>\n                    <p>Username: <a>{usuario.username}</a></p>\n                    <p>Email: <a>{usuario.email}</a></p>\n                  \n                    <Input register={register} name=\"username\" icon={FiUser} placeholder=\"Your New Username\" error={errors.username?.message}/>\n                    <Input register={register} name=\"email\" icon={FiVoicemail} placeholder=\"Your New Email\" error={errors.email?.message}/>\n                    <Button type=\"submit\" size={'100%'}>Change</Button>\n                    <Button size={'40%'} margin={'40px'} onClick={()=>(localStorage.removeItem('@GestãoDeHábitos:access'), history.push(\"/login\"))} >Logout</Button>\n              </form>\n            </AnimationContainer>\n            \n        </Container>\n    )\n}\nexport default MyAcount\n"]},"metadata":{},"sourceType":"module"}