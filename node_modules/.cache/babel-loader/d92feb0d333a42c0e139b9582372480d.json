{"ast":null,"code":"var _jsxFileName = \"/home/gustazacchi/gestao-de-habitos/src/providers/habits/index.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport jwt_decode from 'jwt-decode';\nimport { createContext, useCallback, useContext, useEffect, useState } from 'react';\nimport api from '../../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const HabitsContext = /*#__PURE__*/createContext();\n\nconst HabitsProvider = ({\n  children\n}) => {\n  _s();\n\n  const [user_id, setUser_id] = useState(\"\");\n  const [token, setToken] = useState(null);\n  const [habits, setHabits] = useState([]);\n\n  const getToken = () => {\n    const localToken = JSON.parse(localStorage.getItem('@GestãoDeHábitos:access')); // user id\n\n    if (localToken !== null) {\n      setToken(localToken);\n      api.defaults.headers.authorization = `Bearer ${localToken}`;\n      const decoded = jwt_decode(localToken);\n      setUser_id(decoded.user_id);\n    }\n  };\n\n  const getHabits = useCallback(() => {\n    console.log(\"passou pelo cardList\", token);\n    const localToken = JSON.parse(localStorage.getItem('@GestãoDeHábitos:access'));\n    api.defaults.headers.authorization = `Bearer ${localToken}`;\n    api.get(\"/habits/personal/\").then(res => setHabits(res.data));\n  }, [habits]);\n  useEffect(() => {\n    getToken();\n  });\n  useEffect(() => {\n    if (token) {\n      getHabits();\n    }\n  }, [token]);\n  console.log(\"passou pelo provider\", token);\n  return /*#__PURE__*/_jsxDEV(HabitsContext.Provider, {\n    value: {\n      token: token,\n      user_id,\n      setToken,\n      habits,\n      getHabits\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 43,\n    columnNumber: 5\n  }, this);\n};\n\n_s(HabitsProvider, \"vZW4TgRVP+za4x9PfZATj854Zo4=\");\n\n_c = HabitsProvider;\nexport const useHabits = () => {\n  _s2();\n\n  return useContext(HabitsContext);\n};\n\n_s2(useHabits, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nexport default HabitsProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"HabitsProvider\");","map":{"version":3,"sources":["/home/gustazacchi/gestao-de-habitos/src/providers/habits/index.js"],"names":["jwt_decode","createContext","useCallback","useContext","useEffect","useState","api","HabitsContext","HabitsProvider","children","user_id","setUser_id","token","setToken","habits","setHabits","getToken","localToken","JSON","parse","localStorage","getItem","defaults","headers","authorization","decoded","getHabits","console","log","get","then","res","data","useHabits"],"mappings":";;;;AAAA,OAAOA,UAAP,MAAuB,YAAvB;AACA,SAASC,aAAT,EAAwBC,WAAxB,EAAqCC,UAArC,EAAiDC,SAAjD,EAA4DC,QAA5D,QAA4E,OAA5E;AACA,OAAOC,GAAP,MAAgB,oBAAhB;;AAEA,OAAO,MAAMC,aAAa,gBAAGN,aAAa,EAAnC;;AAEP,MAAMO,cAAc,GAAG,CAAC;AAACC,EAAAA;AAAD,CAAD,KAAgB;AAAA;;AACrC,QAAM,CAACC,OAAD,EAAUC,UAAV,IAAwBN,QAAQ,CAAC,EAAD,CAAtC;AACA,QAAM,CAACO,KAAD,EAAQC,QAAR,IAAoBR,QAAQ,CAAC,IAAD,CAAlC;AACA,QAAM,CAACS,MAAD,EAASC,SAAT,IAAsBV,QAAQ,CAAC,EAAD,CAApC;;AAEA,QAAMW,QAAQ,GAAG,MAAM;AACrB,UAAMC,UAAU,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,yBAArB,CAAX,CAAnB,CADqB,CAErB;;AACA,QAAIJ,UAAU,KAAK,IAAnB,EAAyB;AACvBJ,MAAAA,QAAQ,CAACI,UAAD,CAAR;AACAX,MAAAA,GAAG,CAACgB,QAAJ,CAAaC,OAAb,CAAqBC,aAArB,GAAsC,UAASP,UAAW,EAA1D;AACA,YAAMQ,OAAO,GAAGzB,UAAU,CAACiB,UAAD,CAA1B;AACAN,MAAAA,UAAU,CAACc,OAAO,CAACf,OAAT,CAAV;AACD;AACF,GATD;;AAWA,QAAMgB,SAAS,GAAGxB,WAAW,CAAC,MAAM;AAClCyB,IAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ,EAAoChB,KAApC;AACA,UAAMK,UAAU,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,yBAArB,CAAX,CAAnB;AACAf,IAAAA,GAAG,CAACgB,QAAJ,CAAaC,OAAb,CAAqBC,aAArB,GAAsC,UAASP,UAAW,EAA1D;AACAX,IAAAA,GAAG,CAACuB,GAAJ,CAAQ,mBAAR,EACCC,IADD,CACMC,GAAG,IAAIhB,SAAS,CAACgB,GAAG,CAACC,IAAL,CADtB;AAED,GAN4B,EAM1B,CAAClB,MAAD,CAN0B,CAA7B;AAQAV,EAAAA,SAAS,CAAE,MAAM;AACfY,IAAAA,QAAQ;AACT,GAFQ,CAAT;AAIAZ,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIQ,KAAJ,EAAW;AACXc,MAAAA,SAAS;AACR;AACF,GAJQ,EAIN,CAACd,KAAD,CAJM,CAAT;AAMAe,EAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ,EAAmChB,KAAnC;AACA,sBACE,QAAC,aAAD,CAAe,QAAf;AAAwB,IAAA,KAAK,EAAE;AAACA,MAAAA,KAAK,EAAEA,KAAR;AAAeF,MAAAA,OAAf;AAAwBG,MAAAA,QAAxB;AAAkCC,MAAAA,MAAlC;AAA0CY,MAAAA;AAA1C,KAA/B;AAAA,cACGjB;AADH;AAAA;AAAA;AAAA;AAAA,UADF;AAKD,CAxCD;;GAAMD,c;;KAAAA,c;AA0CN,OAAO,MAAMyB,SAAS,GAAG;AAAA;;AAAA,SAAM9B,UAAU,CAACI,aAAD,CAAhB;AAAA,CAAlB;;IAAM0B,S;;AACb,eAAezB,cAAf","sourcesContent":["import jwt_decode from 'jwt-decode';\nimport { createContext, useCallback, useContext, useEffect, useState } from 'react';\nimport api from '../../services/api';\n\nexport const HabitsContext = createContext();\n\nconst HabitsProvider = ({children}) => {\n  const [user_id, setUser_id] = useState(\"\")\n  const [token, setToken] = useState(null)\n  const [habits, setHabits] = useState([]);\n\n  const getToken = () => {\n    const localToken = JSON.parse(localStorage.getItem('@GestãoDeHábitos:access'))\n    // user id\n    if (localToken !== null) {\n      setToken(localToken)\n      api.defaults.headers.authorization = `Bearer ${localToken}`;\n      const decoded = jwt_decode(localToken)\n      setUser_id(decoded.user_id)\n    }\n  };\n\n  const getHabits = useCallback(() => {\n    console.log(\"passou pelo cardList\", token)\n    const localToken = JSON.parse(localStorage.getItem('@GestãoDeHábitos:access'))\n    api.defaults.headers.authorization = `Bearer ${localToken}`;\n    api.get(\"/habits/personal/\")\n    .then(res => setHabits(res.data))\n  }, [habits])\n\n  useEffect (() => {\n    getToken();\n  });\n\n  useEffect(() => {\n    if (token) {\n    getHabits();\n    }\n  }, [token])\n\n  console.log(\"passou pelo provider\",token)\n  return (\n    <HabitsContext.Provider value={{token: token, user_id, setToken, habits, getHabits}}>\n      {children}\n    </HabitsContext.Provider>\n  );\n};\n\nexport const useHabits = () => useContext(HabitsContext);\nexport default HabitsProvider;\n"]},"metadata":{},"sourceType":"module"}